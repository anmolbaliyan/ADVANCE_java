package com.rays.jdbc;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;

public class TestConnection {

	public static void main(String[] args) throws Exception {

		Class.forName("com.mysql.cj.jdbc.Driver");

		Connection conn = DriverManager.getConnection("jdbc:mysql://localhost:3306/advance_java", "root", "1234567890");

		System.out.println("java is connected with mysql successfully....");

		Statement stmt = conn.createStatement();

		//int i = stmt.executeUpdate(
		//		"create table st_user(id int primary key, firstname varchar(45), lastname varchar(45), login varchar(45), password varchar(45), dob date)");

		//System.out.println(i + " table created");

		/*int j = stmt.executeUpdate("insert into st_user(id, firstname, lastname, login, password, dob) values "
				+ "(6, 'Rohit', 'Sharma', 'rohit01', 'roh123', '1997-04-12'), "
				+ "(7, 'Sneha', 'Patel', 'sneha01', 'sne123', '2001-09-21'), "
				+ "(8, 'Karan', 'Mehta', 'karan01', 'kar123', '1998-12-05'), "
				+ "(9, 'Pooja', 'Singh', 'pooja01', 'poo123', '2000-06-17'), "
				+ "(10, 'Arjun', 'Nair', 'arjun01', 'arj123', '1999-02-28')");*/

		//System.out.println(j + " data added");
		
		/*int k = stmt.executeUpdate(
			    "insert into st_user(id, firstname, lastname, login, password, dob) values " +
			    	    "(1, 'Anmol', 'Baliyan', 'anmol01', 'pass123', '2002-05-10'), " +
			    	    "(2, 'Raman', 'Sharma', 'raman01', 'ram123', '1999-08-15'), " +
			    	    "(3, 'Priya', 'Verma', 'priya01', 'pri123', '2000-11-20'), " +
			    	    "(4, 'Amit', 'Singh', 'amit01', 'ami123', '1998-03-25'), " +
			    	    "(5, 'Neha', 'Gupta', 'neha01', 'neh123', '2001-07-18')"
			    	);*/
		
		int l = stmt.executeUpdate(
			    "update st_user set " +
			    "firstname = case id " +
			    "when 1 then 'Rahul' " +
			    "when 5 then 'Meera' " +
			    "when 7 then 'Karan' " +
			    "when 9 then 'Divya' " +
			    "when 4 then 'Sandeep' end, " +
			    "lastname = case id " +
			    "when 1 then 'Verma' " +
			    "when 5 then 'Iyer' " +
			    "when 7 then 'Malhotra' " +
			    "when 9 then 'Kapoor' " +
			    "when 4 then 'Yadav' end, " +
			    "login = case id " +
			    "when 1 then 'rahul01' " +
			    "when 5 then 'meera01' " +
			    "when 7 then 'karan01' " +
			    "when 9 then 'divya01' " +
			    "when 4 then 'sandeep01' end, " +
			    "password = case id " +
			    "when 1 then 'rah123' " +
			    "when 5 then 'mee123' " +
			    "when 7 then 'kar123' " +
			    "when 9 then 'div123' " +
			    "when 4 then 'san123' end, " +
			    "dob = case id " +
			    "when 1 then '1998-01-15' " +
			    "when 5 then '2000-06-20' " +
			    "when 7 then '1999-09-12' " +
			    "when 9 then '2001-03-08' " +
			    "when 4 then '1997-11-25' end " +
			    "where id in (1,5,7,9,4)"
			);
		
		System.out.println(l + " row affected..(records updated)");

		conn.close();
		stmt.close();

	}

}
